
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Verwandle deine Fotos in farbige Lithophanien für den 3D-Druck – mit CMYK-basierter additiver Farbmischung und AMS-Unterstützung">
      
      
      
        <link rel="canonical" href="https://feurer98.github.io/PIXEstL/ARCHITECTURE/">
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>PIXEstL Architecture Documentation - PIXEstL - Farb-Lithophanie-Generator</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pixestl-architecture-documentation" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href=".." title="PIXEstL - Farb-Lithophanie-Generator" class="md-header__button md-logo" aria-label="PIXEstL - Farb-Lithophanie-Generator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PIXEstL - Farb-Lithophanie-Generator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PIXEstL Architecture Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Dunkles Design aktivieren"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dunkles Design aktivieren" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Helles Design aktivieren"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Helles Design aktivieren" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
        <button type="reset" class="md-search__icon md-icon" title="Zurücksetzen" aria-label="Zurücksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/feurer98/PIXEstL" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    feurer98/PIXEstL
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Hauptnavigation" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Startseite

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../schnellstart/" class="md-tabs__link">
        
  
  
    
  
  Schnellstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../installation/windows/" class="md-tabs__link">
          
  
  
    
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../anleitung/uebersicht/" class="md-tabs__link">
          
  
  
    
  
  Anleitung

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../referenz/parameter/" class="md-tabs__link">
          
  
  
    
  
  Referenz

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../galerie/" class="md-tabs__link">
        
  
  
    
  
  Galerie

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PIXEstL - Farb-Lithophanie-Generator" class="md-nav__button md-logo" aria-label="PIXEstL - Farb-Lithophanie-Generator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PIXEstL - Farb-Lithophanie-Generator
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/feurer98/PIXEstL" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    feurer98/PIXEstL
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Startseite
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../schnellstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schnellstart
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/unix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    macOS / Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Anleitung
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Anleitung
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anleitung/uebersicht/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Übersicht
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anleitung/kalibrierung/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Palette kalibrieren
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anleitung/bild-vorbereiten/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Bild vorbereiten
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anleitung/generierung/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. PIXEstL ausführen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anleitung/slicer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Slicer einrichten
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anleitung/druck/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Drucken
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Referenz
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Referenz
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../referenz/parameter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alle Parameter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../referenz/palette-format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Palette-Format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../galerie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Galerie
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-level-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        High-Level Architecture
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      
        Module Breakdown
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Module Breakdown">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-entry-point-cli" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Entry Point &amp; CLI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-palette-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Palette Module
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Palette Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-palette-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Palette Loading
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-color-combination-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Color Combination Generation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-color-quantization" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Color Quantization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-multi-group-support-ams-with-limited-colors" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 Multi-Group Support (AMS with limited colors)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-color-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Color Utilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Color Utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rgb-red-green-blue" class="md-nav__link">
    <span class="md-ellipsis">
      
        RGB (Red, Green, Blue)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hsl-hue-saturation-lightness" class="md-nav__link">
    <span class="md-ellipsis">
      
        HSL (Hue, Saturation, Lightness)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmyk-cyan-magenta-yellow-keyblack" class="md-nav__link">
    <span class="md-ellipsis">
      
        CMYK (Cyan, Magenta, Yellow, Key/Black)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cielab" class="md-nav__link">
    <span class="md-ellipsis">
      
        CIELab
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-image-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Image Processing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Image Processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-image-resizing" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Image Resizing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-grayscale-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Grayscale Conversion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-transparency-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Transparency Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-image-flipping" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Image Flipping
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-stl-generation-csg" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. STL Generation &amp; CSG
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. STL Generation &amp; CSG">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-thread-based-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Thread-Based Processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-layer-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 Layer Types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-csg-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 CSG Operations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-output-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Output Generation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Flow
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Flow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-processing-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Main Processing Pipeline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algorithm-1-colorcombi-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Algorithm 1: ColorCombi Generation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithm-2-color-quantization-with-threading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Algorithm 2: Color Quantization with Threading
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithm-3-texture-height-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Algorithm 3: Texture Height Mapping
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#java-to-rust-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java-to-Rust Mapping
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Java-to-Rust Mapping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#module-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Module Mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-to-struct-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class-to-Struct Mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threading-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Threading Model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dependencies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#java-from-pomxml" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java (from pom.xml)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rust-proposed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rust (proposed)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Performance Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bottlenecks-in-java-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bottlenecks in Java Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rust-optimization-opportunities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rust Optimization Opportunities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Special Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Special Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-additive-vs-full-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. ADDITIVE vs FULL Mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ams-automatic-material-system-support" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. AMS (Automatic Material System) Support
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-transparency-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Transparency Handling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-curve-mode-advanced" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Curve Mode (Advanced)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing Strategy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-tests-per-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unit Tests (Per Module)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration Tests
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#property-based-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Property-Based Tests
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-questions-for-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Open Questions for Implementation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="pixestl-architecture-documentation">PIXEstL Architecture Documentation<a class="headerlink" href="#pixestl-architecture-documentation" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>PIXEstL is a command-line tool for creating color lithophanes for 3D printing with multi-color filaments (CMYK-based additive color mixing). This document provides a comprehensive analysis of the Java implementation to guide the Rust port.</p>
<h2 id="high-level-architecture">High-Level Architecture<a class="headerlink" href="#high-level-architecture" title="Permanent link">&para;</a></h2>
<pre class="mermaid"><code>graph TD
    A[CLI Arguments] --&gt; B[CommandArgsParser]
    B --&gt; C[GenInstruction]
    C --&gt; D[PlateGenerator]
    D --&gt; E[Palette]
    D --&gt; F[ImageUtil]
    E --&gt; G[Color Quantization]
    F --&gt; H[Image Resize/Process]
    G --&gt; I[StlMaker]
    H --&gt; I
    I --&gt; J[CSG Threads]
    J --&gt; K[Color Layers STL]
    J --&gt; L[Texture Layer STL]
    J --&gt; M[Support Plate STL]
    K --&gt; N[ZIP Output]
    L --&gt; N
    M --&gt; N</code></pre>
<h2 id="module-breakdown">Module Breakdown<a class="headerlink" href="#module-breakdown" title="Permanent link">&para;</a></h2>
<h3 id="1-entry-point-cli">1. Entry Point &amp; CLI<a class="headerlink" href="#1-entry-point-cli" title="Permanent link">&para;</a></h3>
<p><strong>Java Classes:</strong>
- <code>Main.java</code> - Entry point
- <code>CommandArgsParser.java</code> - CLI argument parsing using Apache Commons CLI
- <code>GenInstruction.java</code> - Configuration data structure</p>
<p><strong>Responsibilities:</strong>
- Parse CLI arguments
- Validate input parameters
- Create configuration object
- Invoke main processing pipeline</p>
<p><strong>Key Parameters:</strong>
- Input image path, palette path
- Output dimensions (width/height in mm)
- Pixel dimensions (color pixel width, texture pixel width)
- Layer configuration (number of layers, thickness)
- Color distance method (RGB, CIELab)
- Pixel creation method (ADDITIVE, FULL)
- Thread configuration for parallel processing</p>
<h3 id="2-palette-module">2. Palette Module<a class="headerlink" href="#2-palette-module" title="Permanent link">&para;</a></h3>
<p><strong>Java Classes:</strong>
- <code>Palette.java</code> - Palette management and color quantization
- <code>ColorLayer.java</code> - Single color layer with CMYK values
- <code>ColorCombi.java</code> - Combination of color layers</p>
<p><strong>Responsibilities:</strong></p>
<h4 id="21-palette-loading">2.1 Palette Loading<a class="headerlink" href="#21-palette-loading" title="Permanent link">&para;</a></h4>
<ul>
<li>Load JSON palette file</li>
<li>Parse filament definitions with layers</li>
<li>Each filament has:</li>
<li>Hex code (e.g., <code>#0086D6</code>)</li>
<li>Name (e.g., "Cyan[PLA Basic]")</li>
<li>Active flag</li>
<li>Layers (1-5) with HSL or hex values</li>
</ul>
<h4 id="22-color-combination-generation">2.2 Color Combination Generation<a class="headerlink" href="#22-color-combination-generation" title="Permanent link">&para;</a></h4>
<p><strong>Algorithm for ADDITIVE mode:</strong>
1. Read all active filaments from palette
2. For each filament, extract layers (1-5) with HSL values
3. Convert HSL → CMYK for each layer
4. Generate all possible combinations that sum to <code>colorPixelLayerNumber</code> layers (default: 5)
5. Compute final color by:
   - Sum CMYK values of all layers in combination
   - Clamp CMYK values to [0, 1]
   - Convert CMYK → RGB for comparison</p>
<p><strong>Example:</strong>
- Cyan Layer 3 (0.3mm) + Magenta Layer 2 (0.2mm) = 5 layers total
- CMYK: (C₁+C₂, M₁+M₂, Y₁+Y₂, K₁+K₂) → RGB</p>
<h4 id="23-color-quantization">2.3 Color Quantization<a class="headerlink" href="#23-color-quantization" title="Permanent link">&para;</a></h4>
<p><strong>Algorithm:</strong>
1. For each pixel in source image:
   - Skip transparent pixels
   - Find closest color from pre-computed ColorCombi list
   - Use color distance metric (RGB or CIELab)
2. Parallel processing using thread pool
3. Return quantized image with palette colors only</p>
<h4 id="24-multi-group-support-ams-with-limited-colors">2.4 Multi-Group Support (AMS with limited colors)<a class="headerlink" href="#24-multi-group-support-ams-with-limited-colors" title="Permanent link">&para;</a></h4>
<ul>
<li>If <code>colorNumber</code> is set (e.g., 4 for one AMS):</li>
<li>Split filaments into groups</li>
<li>Each group has max <code>colorNumber-1</code> colors (+ white)</li>
<li>Generate swap instructions for layer changes</li>
</ul>
<h3 id="3-color-utilities">3. Color Utilities<a class="headerlink" href="#3-color-utilities" title="Permanent link">&para;</a></h3>
<p><strong>Java Class:</strong> <code>ColorUtil.java</code></p>
<p><strong>Color Spaces:</strong></p>
<h4 id="rgb-red-green-blue">RGB (Red, Green, Blue)<a class="headerlink" href="#rgb-red-green-blue" title="Permanent link">&para;</a></h4>
<ul>
<li>Standard 8-bit per channel (0-255)</li>
<li>Used for image I/O and basic operations</li>
</ul>
<h4 id="hsl-hue-saturation-lightness">HSL (Hue, Saturation, Lightness)<a class="headerlink" href="#hsl-hue-saturation-lightness" title="Permanent link">&para;</a></h4>
<ul>
<li>Hue: 0-360 degrees</li>
<li>Saturation: 0-100%</li>
<li>Lightness: 0-100%</li>
<li>Used in palette JSON for layer definitions</li>
</ul>
<h4 id="cmyk-cyan-magenta-yellow-keyblack">CMYK (Cyan, Magenta, Yellow, Key/Black)<a class="headerlink" href="#cmyk-cyan-magenta-yellow-keyblack" title="Permanent link">&para;</a></h4>
<ul>
<li>Each component: 0.0-1.0</li>
<li>Used for additive color mixing</li>
<li>Formula: HSL → RGB → CMYK</li>
</ul>
<h4 id="cielab">CIELab<a class="headerlink" href="#cielab" title="Permanent link">&para;</a></h4>
<ul>
<li>L: Lightness (0-100)</li>
<li>a: Green-Red axis</li>
<li>b: Blue-Yellow axis</li>
<li>Perceptually uniform color space</li>
<li>Used for accurate color distance</li>
</ul>
<p><strong>Conversion Pipeline:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>HSL → RGB (via hueToRgb helper)
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>RGB → XYZ (D65 illuminant)
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>XYZ → CIELab (using pivot functions)
</code></pre></div></p>
<p><strong>Color Distance Algorithms:</strong></p>
<ol>
<li>
<p><strong>RGB Distance (Euclidean):</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>d = √((R₁-R₂)² + (G₁-G₂)² + (B₁-B₂)²)
</code></pre></div></p>
</li>
<li>
<p><strong>CIELab Distance (Delta E - CIE76):</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>ΔE = √((L₁-L₂)² + (a₁-a₂)² + (b₁-b₂)²)
</code></pre></div></p>
</li>
<li>More perceptually accurate than RGB</li>
<li>Default method in PIXEstL</li>
</ol>
<h3 id="4-image-processing">4. Image Processing<a class="headerlink" href="#4-image-processing" title="Permanent link">&para;</a></h3>
<p><strong>Java Class:</strong> <code>ImageUtil.java</code></p>
<p><strong>Operations:</strong></p>
<h4 id="41-image-resizing">4.1 Image Resizing<a class="headerlink" href="#41-image-resizing" title="Permanent link">&para;</a></h4>
<ul>
<li>Calculate pixel count based on physical dimensions (mm) and pixel size (mm)</li>
<li>Preserve aspect ratio if only width or height is specified</li>
<li>Use Java2D for resampling</li>
</ul>
<h4 id="42-grayscale-conversion">4.2 Grayscale Conversion<a class="headerlink" href="#42-grayscale-conversion" title="Permanent link">&para;</a></h4>
<ul>
<li>Formula (BT.709 standard):
  <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Luminance = 0.2126 * R + 0.7152 * G + 0.0722 * B
</code></pre></div></li>
<li>Used for texture layer generation</li>
</ul>
<h4 id="43-transparency-handling">4.3 Transparency Handling<a class="headerlink" href="#43-transparency-handling" title="Permanent link">&para;</a></h4>
<ul>
<li>Check alpha channel (TYPE_INT_ARGB)</li>
<li>Transparent pixels skipped in color quantization</li>
<li>Transparency creates cutouts in final STL</li>
</ul>
<h4 id="44-image-flipping">4.4 Image Flipping<a class="headerlink" href="#44-image-flipping" title="Permanent link">&para;</a></h4>
<ul>
<li>Vertical flip (mirror Y-axis) before STL generation</li>
<li>Corrects coordinate system mismatch</li>
</ul>
<h3 id="5-stl-generation-csg">5. STL Generation &amp; CSG<a class="headerlink" href="#5-stl-generation-csg" title="Permanent link">&para;</a></h3>
<p><strong>Java Classes:</strong>
- <code>StlMaker.java</code> - Main STL generation orchestrator
- <code>CSGWorkData.java</code> - Shared data structure for CSG threads
- <code>CSGThread*.java</code> - Thread implementations for parallel processing</p>
<p><strong>Architecture:</strong></p>
<h4 id="51-thread-based-processing">5.1 Thread-Based Processing<a class="headerlink" href="#51-thread-based-processing" title="Permanent link">&para;</a></h4>
<ul>
<li>Executor service with configurable thread pool</li>
<li>Separate threads for:</li>
<li>Each color layer group</li>
<li>Texture layer</li>
<li>Support plate</li>
<li>Row-based parallelization within each thread</li>
</ul>
<h4 id="52-layer-types">5.2 Layer Types<a class="headerlink" href="#52-layer-types" title="Permanent link">&para;</a></h4>
<p><strong>Color Layers (CSGThreadColor):</strong>
- One STL file per color/color group
- For each pixel with this color:
  - Create cuboid at (x, y) position
  - Width/Height: <code>colorPixelWidth</code> (default 0.8mm)
  - Thickness: Sum of layers for this color in ColorCombi
  - Z-offset: Based on position in layer stack</p>
<p><strong>Texture Layer (CSGThreadTexture):</strong>
- Single STL file (usually white)
- For each pixel:
  - Grayscale value → height mapping
  - Black (0) → <code>textureMinThickness</code> (default 0.2mm)
  - White (255) → <code>textureMaxThickness</code> (default 2.5mm)
  - Linear interpolation for intermediate values
- Creates 3D relief effect</p>
<p><strong>Support Plate (CSGSupportPlate):</strong>
- Base plate at Z=0
- Thickness: <code>plateThickness</code> (default 0.2mm)
- Covers entire image area
- Handles transparency (creates holes for transparent pixels)</p>
<h4 id="53-csg-operations">5.3 CSG Operations<a class="headerlink" href="#53-csg-operations" title="Permanent link">&para;</a></h4>
<ul>
<li>Uses JCSG library (Java Constructive Solid Geometry)</li>
<li>Operations: union, difference, intersection</li>
<li>Generates triangle meshes</li>
<li>Binary STL output</li>
</ul>
<h3 id="6-output-generation">6. Output Generation<a class="headerlink" href="#6-output-generation" title="Permanent link">&para;</a></h3>
<p><strong>Format:</strong> ZIP archive containing:
- <code>layer-&lt;color&gt;.stl</code> - One per active color
- <code>layer-plate.stl</code> - Support plate
- <code>layer-texture-&lt;color&gt;.stl</code> - Texture layer
- <code>image-color-preview.png</code> - Quantized color preview
- <code>image-texture-preview.png</code> - Grayscale texture preview
- <code>instructions.txt</code> - Filament swap instructions (if using AMS mode)</p>
<h2 id="data-flow">Data Flow<a class="headerlink" href="#data-flow" title="Permanent link">&para;</a></h2>
<h3 id="main-processing-pipeline">Main Processing Pipeline<a class="headerlink" href="#main-processing-pipeline" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>1. Parse CLI Arguments
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>   ↓
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>2. Load Palette JSON
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>   → Parse filament definitions
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>   → Generate ColorCombi list (all possible layer combinations)
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>   ↓
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>3. Load &amp; Process Source Image
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>   → Resize for color processing (colorPixelWidth)
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>   → Resize for texture processing (texturePixelWidth)
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>   ↓
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>4. Color Quantization (if colorLayer=true)
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>   → For each pixel: find closest ColorCombi
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>   → Parallel processing using thread pool
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>   → Store mapping: RGB → ColorCombi
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>   ↓
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>5. Grayscale Conversion (if textureLayer=true)
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>   → Convert to luminance values
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>   ↓
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>6. Flip Images
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>   → Vertical flip for STL coordinate system
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>   ↓
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>7. Generate STL Files (Parallel)
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>   → Color Layers: Per-color threads
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>   → Texture Layer: Single thread
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>   → Support Plate: Single thread or fast generation
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>   ↓
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>8. Package Output
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>   → Create ZIP archive
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>   → Add all STL files
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>   → Add preview images
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>   → Add instructions (if applicable)
</code></pre></div>
<h2 id="key-algorithms">Key Algorithms<a class="headerlink" href="#key-algorithms" title="Permanent link">&para;</a></h2>
<h3 id="algorithm-1-colorcombi-generation">Algorithm 1: ColorCombi Generation<a class="headerlink" href="#algorithm-1-colorcombi-generation" title="Permanent link">&para;</a></h3>
<p><strong>Purpose:</strong> Generate all possible color combinations that sum to exactly N layers.</p>
<p><strong>Input:</strong>
- List of ColorLayer objects (from palette)
- Target layer count (e.g., 5)</p>
<p><strong>Output:</strong>
- List of ColorCombi objects</p>
<p><strong>Pseudocode:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>function createMultiCombi(colorLayers, targetLayers):
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    result = []
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    for each colorLayer in colorLayers:
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>        # Single layer
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>        combi = ColorCombi(colorLayer)
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>        if combi.totalLayers == targetLayers:
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>            result.add(combi)
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>        # Recursive combinations
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        if combi.totalLayers &lt; targetLayers:
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>            subCombis = computeCombination(combi, colorLayers, targetLayers)
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>            result.addAll(subCombis)
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    return result
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>function computeCombination(currentCombi, colorLayers, targetLayers):
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    result = []
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>    for each colorLayer in colorLayers:
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>        # Skip if color already in combination (ADDITIVE mode)
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>        if currentCombi.contains(colorLayer.hexCode):
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>            continue
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>        # Skip if would exceed target
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>        if currentCombi.totalLayers + colorLayer.layer &gt; targetLayers:
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>            continue
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>        # Create new combination
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>        newCombi = currentCombi.combine(colorLayer)
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>        if newCombi.totalLayers == targetLayers:
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>            result.add(newCombi)
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>        else:
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>            # Recursive call
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>            subCombis = computeCombination(newCombi, colorLayers, targetLayers)
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>            result.addAll(subCombis)
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>    return result
</code></pre></div></p>
<p><strong>Example:</strong>
- Cyan: layers {5, 4, 3, 2, 1}
- Magenta: layers {5, 4, 3, 2, 1}
- White: layers {5, 4, 3, 2, 1}
- Target: 5 layers</p>
<p>Possible combinations:
- Cyan(5)
- Cyan(3) + White(2)
- Cyan(2) + Magenta(3)
- Cyan(2) + Magenta(2) + White(1)
- etc.</p>
<h3 id="algorithm-2-color-quantization-with-threading">Algorithm 2: Color Quantization with Threading<a class="headerlink" href="#algorithm-2-color-quantization-with-threading" title="Permanent link">&para;</a></h3>
<p><strong>Purpose:</strong> Map each pixel to closest palette color using parallel processing.</p>
<p><strong>Pseudocode:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>function quantizeColors(image, paletteColors, distanceMethod):
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    quantizedImage = new Image(image.width, image.height)
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    threadPool = new ThreadPool(numCores)
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    tasks = []
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    for y in 0..image.height:
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>        for x in 0..image.width:
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>            if isTransparent(image, x, y):
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>                quantizedImage.setRGB(x, y, TRANSPARENT)
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>                continue
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>            pixelColor = image.getRGB(x, y)
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>            task = FindClosestColorTask(x, y, pixelColor, paletteColors, distanceMethod)
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>            threadPool.execute(task)
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>            tasks.add(task)
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>    threadPool.shutdown()
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    threadPool.awaitTermination(timeout)
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>    for task in tasks:
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>        quantizedImage.setRGB(task.x, task.y, task.closestColor)
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>    return quantizedImage
</code></pre></div></p>
<h3 id="algorithm-3-texture-height-mapping">Algorithm 3: Texture Height Mapping<a class="headerlink" href="#algorithm-3-texture-height-mapping" title="Permanent link">&para;</a></h3>
<p><strong>Purpose:</strong> Convert grayscale values to 3D height for texture layer.</p>
<p><strong>Formula:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>height = minThickness + (luminance / 255) * (maxThickness - minThickness)
</code></pre></div></p>
<p>Where:
- luminance: 0 (black) to 255 (white)
- minThickness: Default 0.2mm
- maxThickness: Default 2.5mm</p>
<p><strong>Effect:</strong>
- Dark areas: thinner (more light passes through)
- Light areas: thicker (less light passes through)
- Creates relief/depth effect when backlit</p>
<h2 id="java-to-rust-mapping">Java-to-Rust Mapping<a class="headerlink" href="#java-to-rust-mapping" title="Permanent link">&para;</a></h2>
<h3 id="module-mapping">Module Mapping<a class="headerlink" href="#module-mapping" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Java Package</th>
<th>Rust Module</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ggo.pixestl.arg</code></td>
<td><code>src/cli.rs</code>, <code>src/config.rs</code></td>
<td>CLI parsing and configuration</td>
</tr>
<tr>
<td><code>ggo.pixestl.generator</code></td>
<td><code>src/lib.rs</code>, <code>src/lithophane/generator.rs</code></td>
<td>Main orchestration</td>
</tr>
<tr>
<td><code>ggo.pixestl.palette</code></td>
<td><code>src/palette/</code></td>
<td>Palette loading and color combinations</td>
</tr>
<tr>
<td><code>ggo.pixestl.util.ColorUtil</code></td>
<td><code>src/color/</code></td>
<td>Color space conversions and distance</td>
</tr>
<tr>
<td><code>ggo.pixestl.util.ImageUtil</code></td>
<td><code>src/image/</code></td>
<td>Image loading and processing</td>
</tr>
<tr>
<td><code>ggo.pixestl.stl</code></td>
<td><code>src/stl/</code></td>
<td>STL file generation</td>
</tr>
<tr>
<td><code>ggo.pixestl.csg</code></td>
<td><code>src/geometry/</code>, <code>src/lithophane/</code></td>
<td>3D geometry and mesh generation</td>
</tr>
</tbody>
</table>
<h3 id="class-to-struct-mapping">Class-to-Struct Mapping<a class="headerlink" href="#class-to-struct-mapping" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Java Class</th>
<th>Rust Equivalent</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GenInstruction</code></td>
<td><code>struct Config</code></td>
<td>Configuration with builder pattern</td>
</tr>
<tr>
<td><code>Palette</code></td>
<td><code>struct Palette</code></td>
<td>Owns ColorCombi list</td>
</tr>
<tr>
<td><code>ColorLayer</code></td>
<td><code>struct ColorLayer</code></td>
<td>Immutable data</td>
</tr>
<tr>
<td><code>ColorCombi</code></td>
<td><code>struct ColorCombi</code></td>
<td>Vec of ColorLayer</td>
</tr>
<tr>
<td><code>Color</code> (AWT)</td>
<td><code>struct Rgb</code></td>
<td>Custom type for RGB</td>
</tr>
<tr>
<td><code>BufferedImage</code></td>
<td><code>image::RgbaImage</code></td>
<td>From <code>image</code> crate</td>
</tr>
</tbody>
</table>
<h3 id="threading-model">Threading Model<a class="headerlink" href="#threading-model" title="Permanent link">&para;</a></h3>
<p><strong>Java:</strong>
- <code>ExecutorService</code> with fixed thread pool
- <code>Runnable</code> tasks
- <code>awaitTermination</code> for synchronization</p>
<p><strong>Rust:</strong>
- <code>rayon</code> for data parallelism
- <code>par_iter()</code> for pixel processing
- <code>thread::scope</code> for structured concurrency
- <code>Arc&lt;Mutex&lt;T&gt;&gt;</code> for shared mutable state (if needed)</p>
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h2>
<h3 id="java-from-pomxml">Java (from pom.xml)<a class="headerlink" href="#java-from-pomxml" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Dependency</th>
<th>Purpose</th>
<th>Rust Equivalent</th>
</tr>
</thead>
<tbody>
<tr>
<td>jcsg 0.5.7</td>
<td>CSG operations</td>
<td>Manual implementation or <code>cgmath</code></td>
</tr>
<tr>
<td>javafx-controls</td>
<td>UI (unused in CLI)</td>
<td>N/A</td>
</tr>
<tr>
<td>org.json</td>
<td>JSON parsing</td>
<td><code>serde_json</code></td>
</tr>
<tr>
<td>commons-cli</td>
<td>CLI parsing</td>
<td><code>clap</code></td>
</tr>
</tbody>
</table>
<h3 id="rust-proposed">Rust (proposed)<a class="headerlink" href="#rust-proposed" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Crate</th>
<th>Version</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>clap</td>
<td>4</td>
<td>CLI parsing with derive macros</td>
</tr>
<tr>
<td>image</td>
<td>0.25</td>
<td>Image loading and processing</td>
</tr>
<tr>
<td>nalgebra</td>
<td>0.33</td>
<td>Linear algebra for 3D math</td>
</tr>
<tr>
<td>stl_io</td>
<td>0.7</td>
<td>STL file writing</td>
</tr>
<tr>
<td>serde</td>
<td>1</td>
<td>JSON deserialization</td>
</tr>
<tr>
<td>serde_json</td>
<td>1</td>
<td>JSON parsing</td>
</tr>
<tr>
<td>rayon</td>
<td>1.10</td>
<td>Data parallelism</td>
</tr>
<tr>
<td>thiserror</td>
<td>1</td>
<td>Error type derivation</td>
</tr>
<tr>
<td>anyhow</td>
<td>1</td>
<td>Error handling</td>
</tr>
<tr>
<td>zip</td>
<td>2</td>
<td>ZIP archive creation</td>
</tr>
</tbody>
</table>
<h2 id="performance-considerations">Performance Considerations<a class="headerlink" href="#performance-considerations" title="Permanent link">&para;</a></h2>
<h3 id="bottlenecks-in-java-implementation">Bottlenecks in Java Implementation<a class="headerlink" href="#bottlenecks-in-java-implementation" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Color Quantization:</strong></li>
<li>O(pixels × palette_colors) for distance calculation</li>
<li>Mitigated by threading</li>
<li>
<p>Can be optimized with spatial indexing (k-d tree)</p>
</li>
<li>
<p><strong>ColorCombi Generation:</strong></p>
</li>
<li>Exponential combinations (but pruned early)</li>
<li>Typically &lt;10,000 combinations for standard palettes</li>
<li>
<p>One-time cost at startup</p>
</li>
<li>
<p><strong>STL Generation:</strong></p>
</li>
<li>Each pixel → multiple triangles</li>
<li>Memory-intensive for large images</li>
<li>Java uses "low memory" mode with temp files</li>
</ol>
<h3 id="rust-optimization-opportunities">Rust Optimization Opportunities<a class="headerlink" href="#rust-optimization-opportunities" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>SIMD for Color Distance:</strong></li>
<li>Use <code>packed_simd</code> for vectorized distance calculations</li>
<li>
<p>Process 4-8 colors simultaneously</p>
</li>
<li>
<p><strong>Memory Layout:</strong></p>
</li>
<li>Struct-of-Arrays (SoA) for ColorCombi list</li>
<li>
<p>Cache-friendly iteration</p>
</li>
<li>
<p><strong>Parallel Iterator Chains:</strong></p>
</li>
<li><code>rayon::par_iter()</code> with zero-cost abstraction</li>
<li>
<p>No thread pool overhead</p>
</li>
<li>
<p><strong>Zero-Copy String Handling:</strong></p>
</li>
<li>Use <code>&amp;str</code> instead of <code>String</code> where possible</li>
<li>Intern color hex codes</li>
</ol>
<h2 id="special-features">Special Features<a class="headerlink" href="#special-features" title="Permanent link">&para;</a></h2>
<h3 id="1-additive-vs-full-mode">1. ADDITIVE vs FULL Mode<a class="headerlink" href="#1-additive-vs-full-mode" title="Permanent link">&para;</a></h3>
<p><strong>ADDITIVE (Default):</strong>
- Multiple layers of different colors stack
- CMYK values add up
- Simulates transparent film printing
- Requires white (#FFFFFF) as mandatory color</p>
<p><strong>FULL:</strong>
- Each pixel is solid single color
- No layer stacking
- Simpler but less color accuracy
- Used for pixel art style</p>
<h3 id="2-ams-automatic-material-system-support">2. AMS (Automatic Material System) Support<a class="headerlink" href="#2-ams-automatic-material-system-support" title="Permanent link">&para;</a></h3>
<ul>
<li>Limit colors per layer group (e.g., 4 colors)</li>
<li>Generate multiple layer groups</li>
<li>Provide swap instructions at layer boundaries</li>
<li>Enables 7+ color prints with 4-slot AMS</li>
</ul>
<h3 id="3-transparency-handling">3. Transparency Handling<a class="headerlink" href="#3-transparency-handling" title="Permanent link">&para;</a></h3>
<ul>
<li>Images with alpha channel supported</li>
<li>Transparent pixels create holes in STL</li>
<li>Support plate adapts to image shape</li>
<li>Texture layer handles transparency separately</li>
</ul>
<h3 id="4-curve-mode-advanced">4. Curve Mode (Advanced)<a class="headerlink" href="#4-curve-mode-advanced" title="Permanent link">&para;</a></h3>
<ul>
<li>Parameter: curve value (default 0.0 = off)</li>
<li>Splits color layers into multiple plates</li>
<li>Creates flexible/curved lithophanes</li>
<li>Not compatible with transparency</li>
</ul>
<h2 id="testing-strategy">Testing Strategy<a class="headerlink" href="#testing-strategy" title="Permanent link">&para;</a></h2>
<h3 id="unit-tests-per-module">Unit Tests (Per Module)<a class="headerlink" href="#unit-tests-per-module" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Color Module:</strong></li>
<li>RGB ↔ HSL conversions (known values)</li>
<li>RGB → CIELab (standard test colors)</li>
<li>
<p>Delta E calculations (symmetric, triangle inequality)</p>
</li>
<li>
<p><strong>Palette Module:</strong></p>
</li>
<li>JSON parsing (valid/invalid files)</li>
<li>ColorCombi generation (count, correctness)</li>
<li>
<p>Color quantization (deterministic output)</p>
</li>
<li>
<p><strong>Image Module:</strong></p>
</li>
<li>Resize operations (dimensions)</li>
<li>Grayscale conversion (luminance formula)</li>
<li>
<p>Transparency detection</p>
</li>
<li>
<p><strong>Geometry Module:</strong></p>
</li>
<li>Mesh generation (triangle count, normals)</li>
<li>STL formatting (binary structure)</li>
</ol>
<h3 id="integration-tests">Integration Tests<a class="headerlink" href="#integration-tests" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>End-to-End:</strong></li>
<li>Full pipeline with test image + palette</li>
<li>Verify ZIP contents</li>
<li>
<p>Compare STL file sizes</p>
</li>
<li>
<p><strong>Reference Tests:</strong></p>
</li>
<li>Run both Java and Rust versions</li>
<li>Compare quantized images (should be identical)</li>
<li>Compare STL vertex counts (within tolerance)</li>
</ol>
<h3 id="property-based-tests">Property-Based Tests<a class="headerlink" href="#property-based-tests" title="Permanent link">&para;</a></h3>
<ul>
<li>Color distance is symmetric: d(a,b) = d(b,a)</li>
<li>Color distance is non-negative: d(a,b) ≥ 0</li>
<li>HSL→RGB→HSL roundtrip (within floating point tolerance)</li>
</ul>
<h2 id="open-questions-for-implementation">Open Questions for Implementation<a class="headerlink" href="#open-questions-for-implementation" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>CSG Library:</strong></li>
<li>Java uses JCSG library</li>
<li>Rust: Implement basic mesh operations or find crate?</li>
<li>
<p>Decision: Start with manual triangle mesh generation</p>
</li>
<li>
<p><strong>Parallel Processing Granularity:</strong></p>
</li>
<li>Java uses thread pools at multiple levels</li>
<li>Rust: Rely on rayon's work-stealing?</li>
<li>
<p>Decision: Use rayon throughout, profile if needed</p>
</li>
<li>
<p><strong>Memory Management:</strong></p>
</li>
<li>Java has "low memory" mode with temp files</li>
<li>Rust: Rely on ownership system?</li>
<li>
<p>Decision: Implement if profiling shows issues</p>
</li>
<li>
<p><strong>Error Handling Strategy:</strong></p>
</li>
<li>Java uses checked exceptions</li>
<li>Rust: <code>Result&lt;T, Error&gt;</code> everywhere</li>
<li>Decision: Use <code>anyhow</code> for application, <code>thiserror</code> for library</li>
</ol>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Original PIXEstL: https://github.com/gaugo87/PIXEstL</li>
<li>JCSG Library: https://github.com/miho/JCSG</li>
<li>CIE76 Delta E: https://en.wikipedia.org/wiki/Color_difference#CIE76</li>
<li>STL Format: https://en.wikipedia.org/wiki/STL_(file_format)</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Zurück zum Seitenanfang
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/feurer98/PIXEstL" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "navigation.indexes", "content.code.copy", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>